% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/filter_flexible.R
\name{filter_genes_flexible}
\alias{filter_genes_flexible}
\title{Flexible gene filtering with dynamic criteria}
\usage{
filter_genes_flexible(
  data,
  filters = list(),
  filter_mode = "all",
  keep_columns = NULL,
  verbose = FALSE
)
}
\arguments{
\item{data}{Data frame or data.table to filter}

\item{filters}{List of filter specifications. Each filter can be:
- A list with 'column', 'condition', and 'value' elements
- A function that takes the data and returns a logical vector
- A character string to be evaluated as an expression}

\item{filter_mode}{How to combine multiple filters: "all" (AND) or "any" (OR)}

\item{keep_columns}{Optional character vector of columns to retain in output}

\item{verbose}{Print filtering progress and statistics}
}
\value{
Filtered data frame/data.table
}
\description{
Filter genes using flexible, user-defined criteria on any columns.
Supports multiple filter types including numeric comparisons,
value matching, pattern matching, and custom functions.
}
\examples{
# Example 1: Simple numeric filtering
filtered <- filter_genes_flexible(
  gene_table,
  filters = list(
    list(column = "CPM_heart", condition = ">", value = 50),
    list(column = "biotype", condition = "==", value = "protein_coding")
  )
)

# Example 2: Using \%in\% for multiple values
filtered <- filter_genes_flexible(
  gene_table,
  filters = list(
    list(column = "biotype", condition = "\%in\%",
         value = c("protein_coding", "lincRNA")),
    list(column = "has_eqtl", condition = "==", value = TRUE)
  )
)

# Example 3: Pattern matching with regex
filtered <- filter_genes_flexible(
  gene_table,
  filters = list(
    list(column = "gene_symbol", condition = "matches", value = "^Abc"),
    list(column = "strand", condition = "==", value = "+")
  )
)

# Example 4: Complex filtering with custom function
filtered <- filter_genes_flexible(
  gene_table,
  filters = list(
    # Standard filters
    list(column = "biotype", condition = "==", value = "protein_coding"),
    # Custom function for complex logic
    function(df) df$CPM_heart > 100 | df$CPM_liver > 100,
    # String expression
    "!is.na(human_gene_id)"
  )
)

# Example 5: Filter with NA handling
filtered <- filter_genes_flexible(
  gene_table,
  filters = list(
    list(column = "human_gene_id", condition = "not_na"),
    list(column = "n_variants", condition = ">=", value = 1, na.rm = TRUE)
  )
)

}
